# Migration `20210305071926-migration`

This migration has been generated by patrick at 3/5/2021, 2:19:26 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
    "id" TEXT NOT NULL,
    "address" TEXT NOT NULL,
    "discordId" TEXT NOT NULL,
    "authDetailId" TEXT,

    FOREIGN KEY ("authDetailId") REFERENCES "AuthDetail"("id") ON DELETE SET NULL ON UPDATE CASCADE,
    PRIMARY KEY ("id")
)

CREATE TABLE "AuthDetail" (
    "id" TEXT NOT NULL,
    "nonce" TEXT NOT NULL,
    "timestamp" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id")
)

CREATE TABLE "Nft" (
    "id" TEXT NOT NULL,
    "website" TEXT,
    "contractAddress" TEXT,
    "tokenId" INTEGER NOT NULL,
    "uri" TEXT NOT NULL DEFAULT '',
    "iconUrl" TEXT,
    "chainId" INTEGER NOT NULL,
    "ownerAddress" TEXT NOT NULL,

    FOREIGN KEY ("ownerAddress") REFERENCES "User"("address") ON DELETE CASCADE ON UPDATE CASCADE,
    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.address_unique" ON "User"("address")

CREATE UNIQUE INDEX "User.discordId_unique" ON "User"("discordId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20210305071926-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,35 @@
+datasource DS {
+  provider =  ["postgresql","sqlite"]
+  url = "***"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = "native"
+}
+
+model User {
+  id         String     @id @default(uuid())
+  address    String     @unique
+  discordId String @unique
+  authDetail AuthDetail?
+  nftsOwned Nft[] @relation(name:"nftsOwned")
+}
+
+model AuthDetail {
+  id        String   @id @default(uuid())
+  nonce     String
+  timestamp DateTime @default(now())
+}
+
+model Nft {
+  id        String   @id @default(uuid())
+  website String?
+  contractAddress String?
+  tokenId Int
+  uri String @default("")
+  iconUrl String?
+  chainId Int
+  owner     User     @relation(name:"nftsOwned", fields: [ownerAddress], references: [address])
+  ownerAddress  String
+}
```


